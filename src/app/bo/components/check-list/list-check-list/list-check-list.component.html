
<p-fieldset legend="Recherchez les CheckLists" [toggleable]="true">
    <form [formGroup]="formulaireRecherche" (ngSubmit)="searchCheckLists()">
        <div class="p-fluid p-formgrid grid">
            <div class="field col-4">
                <label>Code</label>
                <input pInputText type="text" formControlName="code" placeholder="...">
            </div>
            <div class="field col-4">
                <label>Titre</label>
                <input pInputText type="text" formControlName="titre" placeholder="...">
            </div>
            <div class="field col-4">
                <label class="mb-2">Type de Checklist</label>
                <p-dropdown [autoDisplayFirst]="false" [resetFilterOnHide]="true" class="ng-dirty" [showClear]="true"
                    [options]="typeChecklistList" formControlName="typeChecklist" [filter]="true"
                    placeholder="Sélectionnez un type de checklist" emptyFilterMessage="Aucun type de checklist"
                    emptyMessage="Aucun type de checklist" scrollHeight="130px">
                    <ng-template let-element pTemplate="item">
                        <div class="flex justify-content-between">
                            <span class="font-12">{{ element?.label }}</span>
                        </div>
                    </ng-template>
                </p-dropdown>
            </div>
        </div>
        <div class="flex justify-content-end center_media mt-2" style="column-gap: 10px;">
            <button pButton pRipple class="p-button-success"
                 icon="pi pi-plus-circle" iconPos="left"
                type="button"  tooltipPosition="bottom" label="Créer une checklist"
                pTooltip="Cliquez ici pour créer une nouvelle checklist"></button>
            <button type="submit" pButton pRipple class="p-button" icon="pi pi-search" iconPos="left"
                label="Rechercher / Rafraîchir" [disabled]="is_loading" style="font-size: 11px !important;"></button>
            <div>
                <button pButton pRipple class="ml-2 p-button-rounded" icon="pi pi-filter-slash" tooltipPosition="left"
                    pTooltip="Cliquez ici pour vider le formulaire" (click)="clearSearch()"></button>
            </div>
        </div>
    </form>
</p-fieldset>
<br>
<hr>
<app-loader *ngIf="is_loading"></app-loader>
<p-card class="m-1 mt-1 mb-1">
    <p-table responsiveLayout="scroll" [value]="checkLists" styleClass="p-datatable-responsive-demo"
        [paginator]="true" [rows]="take" [rowsPerPageOptions]="[10,15,20]" [totalRecords]="totalRecords" [lazy]="true"
        [(first)]="skip" [showCurrentPageReport]="true" dataKey="id" [sortOrder]="1"
        currentPageReportTemplate="Affichage {first} à {last} de {totalRecords} résultats" [rowHover]="true"
        sortField="id">

        <ng-template pTemplate="header">
            <tr>
                <th pSortableColumn="id">ID du checkList <p-sortIcon field="id"></p-sortIcon></th>
                <th pSortableColumn="name">Nom <p-sortIcon field="name"></p-sortIcon></th>
                <th pSortableColumn="niveau">Niveau <p-sortIcon field="niveau"></p-sortIcon></th>
                <th pSortableColumn="code">Code <p-sortIcon field="code"></p-sortIcon></th>
                <th pSortableColumn="description">Description <p-sortIcon field="description"></p-sortIcon></th>
                <th class="text-center">Actions</th>
            </tr>
        </ng-template>
      
        <ng-template pTemplate="body" let-checkList>
            <tr>
                <td>{{ checkList.id }}</td>
                <td>{{ checkList.name }}</td>
                <td>{{ checkList.niveau }}</td>
                <td>{{ checkList.code }}</td>
                <td>{{ checkList.description }}</td>
                <td class="text-center">
                    <div class="cm-action-btn">
                        <i pButton pRipple class="p-button-rounded p-button-info mr-2" icon="pi pi-pencil" tooltipPosition="left"
                             [routerLink]="['/editCheckList', checkList.id]"></i>
                        <i pButton pRipple class="p-button-rounded p-button-danger" icon="pi pi-trash" tooltipPosition="right"
                            (click)="deleteCheckList(checkList)"></i>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</p-card>


